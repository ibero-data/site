---
import LanguageSwitcher from './LanguageSwitcher';
import { getLangFromUrl, getTranslations } from '../lib/i18n';

const lang = getLangFromUrl(Astro.url);
const t = getTranslations(lang);
---

<header class="fixed w-full top-0 z-50 bg-gray-950/80 backdrop-blur-xl border-b border-white/10">
  <nav class="container mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <!-- Logo -->
      <a href={`/${lang === 'en' ? '' : lang}`} class="flex items-center space-x-3">
        <img src="/logo.png" alt="Ibero Data" class="h-10 w-auto" />
        <span class="text-xl font-bold bg-gradient-to-r from-ibero-red to-ibero-yellow bg-clip-text text-transparent">
          Ibero Data
        </span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-8">
        <a href={`#home`} class="text-gray-300 hover:text-ibero-yellow transition-colors font-medium">
          {t.header.home}
        </a>
        <a href={`#services`} class="text-gray-300 hover:text-ibero-yellow transition-colors font-medium">
          {t.header.services}
        </a>
        <a href={`#about`} class="text-gray-300 hover:text-ibero-yellow transition-colors font-medium">
          {t.header.about}
        </a>
        <a href={`#contact`} class="text-gray-300 hover:text-ibero-yellow transition-colors font-medium">
          {t.header.contact}
        </a>
        <LanguageSwitcher client:load currentLang={lang} />
      </div>

      <!-- Mobile Menu Button -->
      <button id="mobile-menu-button" class="md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4 border-t border-gray-200 dark:border-gray-700">
      <div class="flex flex-col space-y-4 mt-4">
        <a href={`#home`} class="text-gray-700 dark:text-gray-300 hover:text-ibero-red transition-colors font-medium">
          {t.header.home}
        </a>
        <a href={`#services`} class="text-gray-700 dark:text-gray-300 hover:text-ibero-red transition-colors font-medium">
          {t.header.services}
        </a>
        <a href={`#about`} class="text-gray-700 dark:text-gray-300 hover:text-ibero-red transition-colors font-medium">
          {t.header.about}
        </a>
        <a href={`#contact`} class="text-gray-700 dark:text-gray-300 hover:text-ibero-red transition-colors font-medium">
          {t.header.contact}
        </a>
        <div class="pt-2">
          <LanguageSwitcher client:load currentLang={lang} />
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });

  // Smooth scrolling for anchor links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({ behavior: 'smooth' });
        mobileMenu?.classList.add('hidden');
      }
    });
  });
</script>